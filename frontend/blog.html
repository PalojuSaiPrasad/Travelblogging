<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Blog - Travel Tales</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <nav>
            <ul id="nav-list">
                <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="create-blog.html" class="create-blog"><i class="fas fa-pencil-alt"></i> Create a Travel
                        Blog</a></li>

            </ul>
        </nav>
    </header>

    <div class="container">
        <h2>Travel Blogs</h2>

        <div id="posts-container">
            <!-- Blog posts will be dynamically inserted here -->
        </div>
    </div>

    <script>
        // Fetch the logged-in user's data from localStorage
        const user = JSON.parse(localStorage.getItem('user'));

        // If a user is logged in, show the "Create Blog Post" button
        if (user) {
            document.getElementById('create-blog-btn').style.display = 'block';
            document.getElementById('logout-link').style.display = 'block';
        } else {
            document.getElementById('logout-link').style.display = 'none'; // Hide logout link if not logged in
        }

        // Fetch all blog posts
        async function fetchPosts() {
            const response = await fetch('http://localhost:5500/api/posts');
            const result = await response.json();

            const postsContainer = document.getElementById('posts-container');
            if (response.ok) {
                if (result.length > 0) {
                    result.forEach(post => {
                        const postElement = document.createElement('div');
                        postElement.classList.add('post');
                        postElement.innerHTML = `
                            <h3>${post.title}</h3>
                            <p>${post.content}</p>
                            <p><em>Posted on: ${new Date(post.createdAt).toLocaleString()}</em></p>
                        `;
                        postsContainer.appendChild(postElement);
                    });
                } else {
                    postsContainer.innerHTML = '<p>No posts found.</p>';

                }
            } else {
                postsContainer.innerHTML = `<p>${result.message || 'Failed to fetch posts'}</p>`;
            }
        }

        fetchPosts();
    </script>
</body>

</html>